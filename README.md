# 住宅ローンデフォルト予測プロジェクト

## 概要

本プロジェクトは、住宅ローンデータセット（`hmeq.csv`）を使用し、顧客がローンの返済を滞納（デフォルト）するかどうかを予測するための**分類モデル**を構築し、評価することを目的としています。

特に、データセットに多く含まれる**欠損値**に焦点を当て、異なる欠損値補完手法（中央値/0補完、多重代入法 (MICE)）を用いた際のモデル性能への影響を比較分析しました。

## 使用データセット

* **ファイル名:** `hmeq.csv`
* **データサイズ:** 5960行、13列
* **目的変数:** `BAD` (デフォルトフラグ: 1=不良債権、0=優良顧客)

### 主な変数

| 変数名 | 説明 | 欠損値数 (5960件中) |
| :--- | :--- | :--- |
| `BAD` | 目的変数：不良債権フラグ (0 or 1) | 0 |
| `LOAN` | ローン金額 | 0 |
| `MORTDUE` | 既存住宅ローン残高 | 518 |
| `VALUE` | 担保不動産の価値 | 112 |
| `REASON` | ローンの理由 (DebtCon/HomeImp) | 252 |
| `JOB` | 職種 | 279 |
| `DEBTINC` | 債務収入比率 (負債総額/収入) | 1267 |
| `YOJ` | 現職での勤続年数 | 515 |
| `DEROG` | 過去の主要な延滞の回数 | 708 |
| `DELINQ` | 過去90日以上の延滞回数 | 580 |
| `CLAGE` | 最古の信用枠からの経過月数 | 308 |
| `NINQ` | 最近の信用照会回数 | 510 |
| `CLNO` | 信用枠の数 | 222 |

## 使用技術とライブラリ

* **言語:** Python 3
* **主要ライブラリ:**
    * `pandas`, `numpy`: データ操作
    * `matplotlib`, `seaborn`, `missingno`: データ可視化・分析
    * `scikit-learn (sklearn)`: 機械学習モデル、前処理、評価
        * `DecisionTreeClassifier` (決定木)
        * `LogisticRegression` (ロジスティック回帰)
        * `SVC` (サポートベクターマシン)
        * `IterativeImputer` (MICE: 多重代入法)
        * `StandardScaler` (標準化)

## データ前処理と分析のハイライト

1.  **欠損値傾向分析:**
    * 各特徴量の欠損傾向を分析するため、欠損のある群とない群で他の特徴量の平均値を比較するt検定を実施しました。
    * `DEBTINC`の欠損は`BAD`（不良債権）の値に大きく依存しているなど、**欠損がランダムではない**（MAR/NMAR）傾向が確認されました。

2.  **欠損値補完手法の比較:**
    * **MICE未使用データセット (`df_nonmice`):** 欠損フラグの作成、カテゴリ変数を`Unknown`で補完、数値変数を中央値または0で補完しました。
    * **MICE使用データセット (`df_mice`):** `IterativeImputer`（ベイジアンリッジ）を用いて、多変量間で予測し合う**多重代入法 (MICE)**による補完を実施しました。

3.  **特徴量エンジニアリング:**
    * カテゴリ変数（`REASON`, `JOB`）に対して**One-Hot Encoding**を適用しました。
    * 連続値変数に対しては、モデル学習前に**標準化**（`StandardScaler`）を行いました。

## モデル構築と評価

* **採用モデル:**
    * ロジスティック回帰 (Logistic Regression)
    * 決定木 (Decision Tree Classifier)
    * サポートベクターマシン (SVC)
* **ハイパーパラメータチューニング:**
    * 決定木モデルは、`GridSearchCV`を使用して、最適なハイパーパラメータを探索しました。
* **評価指標:**
    * Accuracy, Precision, Recall, F1-score, ROC-AUC を採用し、モデルの総合的な性能を評価しました。

## ファイル構成

* `final_project_portfolio.ipynb`: 全てのデータ分析、前処理、モデル構築、評価のプロセスを記載したJupyter Notebook
* `hmeq.csv` (プロジェクトルートに配置を想定): 使用するデータセット
